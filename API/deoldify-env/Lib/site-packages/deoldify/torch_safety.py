
# This module adds functools.partial to PyTorch's safe globals
import torch
import functools

# Try to add functools.partial to PyTorch's safe globals
try:
    torch.serialization.add_safe_globals([functools.partial])
    print("Successfully added functools.partial to PyTorch's safe globals")
except (AttributeError, TypeError) as e:
    print(f"Note: Could not register safe globals: {e} (this is expected with older PyTorch versions)")
